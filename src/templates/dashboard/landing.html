{% extends "base.html" %}
{% load staticfiles %}

{% block content %}
<div class="text-center">
    {% if not request.user.is_anonymous %}
    {% if not request.user.userprofile.ssh_public_key %}
    <div class="alert alert-danger" role="alert">
        Warning: you need to upload an ssh key under <a href="/accounts/settings">account settings</a> if you wish to
        log into the servers you book
    </div>
    {% endif %}
    {% else %}
    {% endif %}
</div>
{% csrf_token %}

<div class="container-fluid">
    <div class="row">
        <!-- About us -->
        <div class="col-12 col-lg-6 mb-4">
            <h2 class="border-bottom">About Us:</h2>
            <p>The Lab as a Service (LaaS) project aims to help in the development and testing of LFN projects such as
                OPNFV
                by hosting hardware and providing access to the community. Currently, the only participating lab is the
                University of New Hampshire Interoperability Lab (UNH-IOL).</p>
            <p>To get started, you can request access to a server at the right. PTL's have the ability to design and
                book a
                whole block of servers with customized layer2 networks (e.g. a Pharos Pod). Read more here: <a
                    href="https://wiki.opnfv.org/display/INF/Lab+as+a+Service+2.0">LaaS Wiki</a></p>
        </div>
        <!-- Get started -->
        <div class="col-12 col-lg-6 mb-4">
            <h2 class="border-bottom">Get Started:</h2>
            {% if request.user.is_anonymous %}
            <h4 class="text-center">
                To get started, please log in with your <a href="/accounts/login">Linux Foundation Jira account</a>
            </h4>
            {% else %}
            <p>To get started, book a server below:</p>
            <a class="btn btn-primary d-flex flex-column justify-content-center align-content-center border text-white p-4"
                href="/booking/quick/">
                <h4>Book a Server</h4>
            </a>
            <p class="mt-4">PTLs can use our advanced options to book multi-node pods. If you are a PTL, you may use the options
                below:
            </p>
            <div class="row">
                <div class="col-12 col-xl-4">
                    <button class="btn btn-primary w-100" onclick="cwf(0)">Book a Pod</button>
                </div>
                <div class="col-12 col-xl-4">
                    <button class="btn btn-primary w-100" onclick="cwf(1)">Design a Pod</button>
                </div>
                <div class="col-12 col-xl-4">
                    <button class="btn btn-primary w-100" onclick="cwf(2)">Configure a Pod</button>
                </div>
            </div>
            {% endif %}
        </div>
        <!-- Returning users -->
        {% if not request.user.is_anonymous %}
        <div class="col-12 col-lg-6 offset-lg-6 mb-4 mt-lg-4">
            <h2 class="ht-4 border-bottom">Returning Users:</h2>
            <p>If you're a returning user, some of the following options may be of interest:</p>
            <div class="row">
                <div class="col-12 col-xl-4">
                    <button class="btn btn-primary w-100" onclick="cwf(3)">Snapshot a Host</button>
                </div>
                <div class="col-12 col-xl-4">
                    <a class="btn btn-primary w-100" href="{% url 'account:my-bookings' %}">
                        My Bookings
                    </a>
                </div>
                {% if manager == True %}
                    <div class="col-12 col-xl-4">
                        <button class="btn btn-primary w-100" onclick="continue_wf()">
                            Resume Workflow
                        </button>
                    </div>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script type="text/javascript">
    function cwf(type) {
        $.ajax({
            type: "POST",
            url: "/",
            data: {
                "create": type
            },
            beforeSend: function (request) {
                request.setRequestHeader("X-CSRFToken",
                    $('input[name="csrfmiddlewaretoken"]').val()
                );
            }

        }).done(function (data) {
            window.location.replace("/wf/");
        }).fail(function (jqxHR, textstatus) {
            alert("Something went wrong...");
        });
    }

    function continue_wf() {
        window.location.replace("/wf/");
    }
</script>

<div class="hidden_form d-none" id="form_div">
    <form method="post" action="" class="form" id="wf_selection_form">
        {% csrf_token %}

        <input type="hidden" id="landing_action">

        <button type="submit" class="btn btn btn-success">
            Confirm Edit
        </button>
    </form>
</div>

{% block vport_comm %}
{% endblock %}
{% endblock content %}