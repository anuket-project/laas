{% extends "base.html" %}
{% load staticfiles %}
{% load bootstrap4 %}
{% block content %}

<div class="text-center">
    {% if not request.user.is_anonymous %}
    {% else %}
    {% endif %}
</div>
{% csrf_token %}

<div class="row">
    <div class="col-12 col-lg-6 mb-4">
        <!-- About us -->
        <h2 class="border-bottom">About Us</h2>
        {% block about_us %}
        <p>Here is some information about us!</p>
        {% endblock about_us %}
        {% block welcome_back %}
            {% if user.is_authenticated %}
            <h2 class="border-bottom">Welcome Back!</h2>
                {% if bookings %}
                    <h5> These are your current bookings: </h5>
                    <ul style="list-style: none;">
                    {% for book in bookings %}
                        <li><a href="/booking/detail/{{ book.id }}/">{{ book.purpose }}</a></li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <h5> You have no current bookings <h5>
                {% endif %}
            {% endif %}
        {% endblock welcome_back %}
    </div>

    <!-- Get started -->
    <div class="col-12 col-lg-6 mb-4">
        <h2 class="border-bottom">Get Started</h2>
        {% if request.user.is_anonymous %}
        {% if LFID %}
        <h4 class="text-center">
            To get started, please log in with <a href="{% url 'oidc_authentication_init' %}" class="inTextLink">Linux Foundation ID</a>
        </h4>
        {% else %}
        <h4 class="text-center">
            To get started, please log in with your <a href="/accounts/login" class="inTextLink">Linux Foundation Jira account</a>
        </h4>
        {% endif %}
        {% else %}
        {% block btnGrp %}
        <p>Select 'Design a Pod' to create a custom resource group.</p>
        <p>Select 'Book a Pod' to reserve a custom pod or a single resource.</p>
        <a class="btn btn-primary btn-lg d-flex flex-column justify-content-center align-content-center border p-4 btnAnuket" href="{% url 'workflow:design_a_pod' %}" >
            Design a Pod
        </a>
        <a class="btn btn-primary btn-lg d-flex flex-column justify-content-center align-content-center border p-4 btnAnuket" href="{% url 'workflow:book_a_pod' %}" >
            Book a Pod
        </a>

        {% endblock btnGrp %}
        {% endif %}
    </div>
</div>

<!-- IPA Modal -->
<div class="modal fade" id="ipa-modal" tabindex="-1">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Welcome to LaaS 3.0</h5>
        </div>
        <div class="modal-body" id="add_resource_modal_body">
            <p>We have made large scale improvements to the dashboard and our host provisioning service to improve your user experience.</p>
            <p>{{ ipa_migrator.message }}</p>
            <form action="{{ipa_migrator.action}}" method="post">
                {% csrf_token %}
                <p class="text-danger">{{error}}</p>
                {{ ipa_migrator.form }}
                <div class="form-group">
                    <input class="btn btn-success" name="submitButton" type="submit" value="{{ipa_migrator.button}}">
                </div>
            </form>
        </div>
      </div>
    </div>
  </div>

<script>

$(window).on('load', function() {
    if ({{ipa_migrator.exists}}) {
        $('#ipa-modal').modal({backdrop: 'static', keyboard: false});
        $('#ipa-modal').modal('show');
    }
    });
</script>

{% endblock content %}
